# ðŸ—ï¸ Arquitetura do Sistema Kazumi - Docker EC2

## ðŸ“Š VisÃ£o Geral

O sistema Kazumi Ã© uma aplicaÃ§Ã£o web full-stack implantada na AWS EC2. A arquitetura Ã© containerizada com Docker para facilitar o deploy e a escalabilidade. Todos os arquivos sÃ£o armazenados localmente no servidor EC2 usando volumes Docker.

---

## ðŸŽ¯ Diagrama de Arquitetura EC2

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           INTERNET / USUÃRIOS                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                                 â”‚ HTTPS/HTTP
                                 â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚    Route 53 (Opcional)  â”‚
                    â”‚    DNS: kazumi.com.br   â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                                 â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          AWS EC2 INSTANCE                                â”‚
â”‚                    ec2-3-137-179-33.us-east-2                           â”‚
â”‚                         (us-east-2 - Ohio)                              â”‚
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                    DOCKER COMPOSE                                â”‚   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚   â”‚
â”‚  â”‚  â”‚         NGINX Container (Port 80)                      â”‚     â”‚   â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚     â”‚   â”‚
â”‚  â”‚  â”‚  â”‚  â€¢ Serve Frontend (React SPA)                â”‚     â”‚     â”‚   â”‚
â”‚  â”‚  â”‚  â”‚  â€¢ Reverse Proxy para API                    â”‚     â”‚     â”‚   â”‚
â”‚  â”‚  â”‚  â”‚  â€¢ Serve Arquivos de Upload (/uploads)       â”‚     â”‚     â”‚   â”‚
â”‚  â”‚  â”‚  â”‚  â€¢ CORS Headers                              â”‚     â”‚     â”‚   â”‚
â”‚  â”‚  â”‚  â”‚  â€¢ Cache de Assets EstÃ¡ticos                 â”‚     â”‚     â”‚   â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚     â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚   â”‚
â”‚  â”‚                          â”‚ Proxy /api â†’ :8000                  â”‚   â”‚
â”‚  â”‚                          â”‚ Volume: /uploads                    â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚   â”‚
â”‚  â”‚  â”‚      FastAPI Backend Container (Port 8000)            â”‚     â”‚   â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚     â”‚   â”‚
â”‚  â”‚  â”‚  â”‚  â€¢ REST API Endpoints                        â”‚     â”‚     â”‚   â”‚
â”‚  â”‚  â”‚  â”‚  â€¢ AutenticaÃ§Ã£o JWT                          â”‚     â”‚     â”‚   â”‚
â”‚  â”‚  â”‚  â”‚  â€¢ Business Logic                            â”‚     â”‚     â”‚   â”‚
â”‚  â”‚  â”‚  â”‚  â€¢ Upload de Arquivos â†’ Local Storage        â”‚     â”‚     â”‚   â”‚
â”‚  â”‚  â”‚  â”‚  â€¢ CORS Configurado                          â”‚     â”‚     â”‚   â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚     â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚   â”‚
â”‚  â”‚                    â”‚                                          â”‚   â”‚
â”‚  â”‚                    â”‚ Volume: /app/uploads                     â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚   â”‚
â”‚  â”‚  â”‚      PostgreSQL Container (Port 5432)               â”‚     â”‚   â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚     â”‚   â”‚
â”‚  â”‚  â”‚  â”‚  â€¢ Banco de Dados Relacional                â”‚   â”‚     â”‚   â”‚
â”‚  â”‚  â”‚  â”‚  â€¢ Armazena: UsuÃ¡rios, Alunos, PEI,         â”‚   â”‚     â”‚   â”‚
â”‚  â”‚  â”‚  â”‚    Mensagens, Eventos, etc.                 â”‚   â”‚     â”‚   â”‚
â”‚  â”‚  â”‚  â”‚  â€¢ Volume Persistente                       â”‚   â”‚     â”‚   â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚     â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚   â”‚
â”‚  â”‚                                                               â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚   â”‚
â”‚  â”‚  â”‚         Docker Volume: uploads_data                 â”‚     â”‚   â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚     â”‚   â”‚
â”‚  â”‚  â”‚  â”‚  profile-pictures/                              â”‚     â”‚   â”‚
â”‚  â”‚  â”‚  â”‚    â””â”€â”€ user_123/                                â”‚     â”‚   â”‚
â”‚  â”‚  â”‚  â”‚         â”œâ”€â”€ abc123.jpg                          â”‚     â”‚   â”‚
â”‚  â”‚  â”‚  â”‚         â””â”€â”€ def456.png                          â”‚     â”‚   â”‚
â”‚  â”‚  â”‚  â”‚                                                 â”‚     â”‚   â”‚
â”‚  â”‚  â”‚  â”‚  student-documents/                             â”‚     â”‚   â”‚
â”‚  â”‚  â”‚  â”‚    â””â”€â”€ student_456/                             â”‚     â”‚   â”‚
â”‚  â”‚  â”‚  â”‚         â”œâ”€â”€ relatorio.pdf                       â”‚     â”‚   â”‚
â”‚  â”‚  â”‚  â”‚         â””â”€â”€ laudo.pdf                           â”‚     â”‚   â”‚
â”‚  â”‚  â”‚  â”‚                                                 â”‚     â”‚   â”‚
â”‚  â”‚  â”‚  â”‚  educational-materials/                         â”‚     â”‚   â”‚
â”‚  â”‚  â”‚  â”‚    â”œâ”€â”€ guia-inclusao.pdf                        â”‚     â”‚   â”‚
â”‚  â”‚  â”‚  â”‚    â”œâ”€â”€ video-tutorial.mp4                       â”‚     â”‚   â”‚
â”‚  â”‚  â”‚  â”‚    â””â”€â”€ apresentacao.pptx                        â”‚     â”‚   â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚     â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚   â”‚
â”‚  â”‚                                                               â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                       â”‚
â”‚  Security Group:                                                      â”‚
â”‚    â€¢ Port 22  (SSH)                                                   â”‚
â”‚    â€¢ Port 80  (HTTP)                                                  â”‚
â”‚    â€¢ Port 443 (HTTPS - com SSL)                                       â”‚
â”‚    â€¢ Port 8000 (API - dev/test)                                       â”‚
â”‚    â€¢ Port 8080 (Frontend - dev/test)                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ðŸ”„ Fluxo de Dados

### 1. Acesso de UsuÃ¡rio (NavegaÃ§Ã£o)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       HTTP        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      Proxy       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚          â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€> â”‚          â”‚
â”‚ Navegadorâ”‚                    â”‚  NGINX   â”‚                  â”‚  FastAPI â”‚
â”‚          â”‚ <â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚  :80     â”‚ <â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚  :8000   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     HTML/JS/CSS    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    JSON/API      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                      â–²
                                      â”‚
                                      â”‚ Static Files
                                      â”‚
                               React Build
                              (dist folder)
```

### 2. Upload de Arquivo

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Frontend â”‚ â”€â”€â”€â”€â”€POSTâ”€â”€â”€â”€â”€â”€â”€â”€>â”‚  FastAPI â”‚                  â”‚  Docker  â”‚
â”‚ (React)  â”‚  /upload/profile- â”‚ Backend  â”‚ â”€â”€â”€salvarâ”€â”€â”€â”€â”€â”€â”€>â”‚  Volume  â”‚
â”‚          â”‚       picture     â”‚          â”‚                  â”‚ /uploads â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â”‚ Save URL
                                    â–¼
                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                              â”‚PostgreSQLâ”‚
                              â”‚   DB     â”‚
                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Passos:
1. UsuÃ¡rio seleciona foto no frontend
2. Frontend envia para API com Authorization Bearer token
3. API valida: tipo de arquivo, tamanho, permissÃµes
4. API salva arquivo localmente no volume Docker
5. API gera URL relativa (/uploads/...)
6. API salva URL no banco de dados
7. API retorna URL para frontend
```

### 3. Leitura de Arquivo

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Frontend â”‚ â”€â”€â”€â”€GET URLâ”€â”€â”€â”€â”€â”€â”€>â”‚PostgreSQLâ”‚                  â”‚  NGINX   â”‚
â”‚ (React)  â”‚ (via API)         â”‚    DB    â”‚                  â”‚  Server  â”‚
â”‚          â”‚                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚          â”‚
â”‚          â”‚                                                 â”‚          â”‚
â”‚  <img>   â”‚ â”€â”€â”€â”€â”€â”€HTTP GETâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€> â”‚          â”‚
â”‚  src=url â”‚                  /uploads/...                  â”‚          â”‚
â”‚          â”‚ <â”€â”€â”€â”€Arquivoâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Passos:
1. Frontend busca metadados (incluindo URL) via API
2. Browser faz requisiÃ§Ã£o HTTP para NGINX
3. NGINX serve arquivo do volume compartilhado
4. Arquivo Ã© exibido no navegador
```

---

## ðŸ” SeguranÃ§a

### Camadas de SeguranÃ§a

1. **Network Layer**

   - Security Groups no EC2
   - Apenas portas necessÃ¡rias abertas
   - SSH restrito a IPs especÃ­ficos (recomendado)

2. **Application Layer**

   - JWT para autenticaÃ§Ã£o
   - CORS configurado
   - ValidaÃ§Ã£o de tipos de arquivo
   - Limites de tamanho de arquivo
   - SanitizaÃ§Ã£o de nomes de arquivo

3. **Data Layer**

   - PostgreSQL isolado em container privado
   - Credenciais em .env (nÃ£o commitadas)

4. **File Storage Layer**
   - Volumes Docker isolados
   - Arquivos servidos apenas via NGINX
   - Sem acesso direto aos arquivos do sistema

---

## ðŸ“¦ Componentes e Tecnologias

### Frontend (Container 1)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   NGINX + React                â”‚
â”‚                                â”‚
â”‚ â€¢ React 18                     â”‚
â”‚ â€¢ Vite (Build Tool)            â”‚
â”‚ â€¢ TypeScript                   â”‚
â”‚ â€¢ Tailwind CSS                 â”‚
â”‚ â€¢ Shadcn/ui Components         â”‚
â”‚ â€¢ React Router                 â”‚
â”‚ â€¢ Axios (HTTP Client)          â”‚
â”‚                                â”‚
â”‚ Build: Multi-stage Dockerfile  â”‚
â”‚ Port: 80                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Backend (Container 2)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   FastAPI + Python             â”‚
â”‚                                â”‚
â”‚ â€¢ FastAPI                      â”‚
â”‚ â€¢ SQLAlchemy (ORM)             â”‚
â”‚ â€¢ Alembic (Migrations)         â”‚
â”‚ â€¢ Pydantic (Validation)        â”‚
â”‚ â€¢ JWT Authentication           â”‚
â”‚ â€¢ python-multipart (Upload)    â”‚
â”‚ â€¢ Local File Storage           â”‚
â”‚                                â”‚
â”‚ Port: 8000                     â”‚
â”‚ Volume: /app/uploads           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Database (Container 3)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   PostgreSQL 15                â”‚
â”‚                                â”‚
â”‚ â€¢ Relational Database          â”‚
â”‚ â€¢ Persistent Volume            â”‚
â”‚ â€¢ Automatic Backups            â”‚
â”‚                                â”‚
â”‚ Port: 5432 (internal)          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### File Storage (Docker Volume)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Docker Volume: uploads_data  â”‚
â”‚                                â”‚
â”‚ â€¢ Local Storage                â”‚
â”‚ â€¢ Persistent across restarts   â”‚
â”‚ â€¢ Shared between containers    â”‚
â”‚ â€¢ Fast I/O performance         â”‚
â”‚ â€¢ No external dependencies     â”‚
â”‚                                â”‚
â”‚ Path: /app/uploads             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ðŸŒŠ Fluxo Completo de RequisiÃ§Ã£o

### Exemplo: UsuÃ¡rio Faz Upload de Foto de Perfil

```
1. â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Browser â”‚ UsuÃ¡rio clica em "Upload de Foto"
   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
        â”‚
        â–¼
2. Frontend valida arquivo (tipo, tamanho)
   file.type === 'image/jpeg' âœ“
   file.size < 5MB âœ“
        â”‚
        â–¼
3. Frontend envia POST para API
   POST /upload/profile-picture
   Headers: {
     Authorization: "Bearer eyJ0eXAi..."
     Content-Type: "multipart/form-data"
   }
   Body: FormData com arquivo
        â”‚
        â–¼
4. â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚  NGINX   â”‚ Recebe requisiÃ§Ã£o na porta 80
   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
        â”‚
        â”‚ Proxy para backend
â€¢ vCPUs: 2
â€¢ RAM: 4 GB
â€¢ Custo: ~$33/mÃªs (us-east-2)
â€¢ Storage (EBS): 50GB = ~$5/mÃªs (incluindo espaÃ§o para uploads)

Alternativa econÃ´mica: t2.micro (free tier)
â€¢ vCPUs: 1
â€¢ RAM: 1 GB
â€¢ Custo: $0 (primeiro ano) ou ~$8.50/mÃªs
â€¢ Storage (EBS): 30GB = ~$3/mÃªs

```

### Total Estimado

```

CenÃ¡rio MÃ­nimo (t2.micro): ~$10/mÃªs
CenÃ¡rio Recomendado (t2.medium): ~$40/mÃªs

ðŸ“‰ Economia em relaÃ§Ã£o Ã  arquitetura com S3: ~$2-5/mÃªs

```

---

## ðŸš€ Escalabilidade Futura

### Horizontal Scaling

```

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Load Balancerâ”‚
â”‚ (ALB) â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚
â”œâ”€â”€â”€â”€â”€â”€> EC2 Instance 1
â”œâ”€â”€â”€â”€â”€â”€> EC2 Instance 2
â””â”€â”€â”€â”€â”€â”€> EC2 Instance 3
â”‚
â””â”€â”€â”€â”€â”€â”€> RDS PostgreSQL
(Managed DB)

```

### Melhorias PossÃ­veis

1. **CloudFront CDN** - Cache de assets estÃ¡ticos
2. **RDS** - PostgreSQL gerenciado
3. **ElastiCache** - Cache Redis/Memcached
4. **Auto Scaling Group** - Escala automÃ¡tica
5. **ECS/EKS** - OrquestraÃ§Ã£o de containers
6. **S3 + CloudFront** - DistribuiÃ§Ã£o global de arquivos

---

## ðŸ“Š Monitoramento

### CloudWatch (AWS)

- MÃ©tricas de EC2 (CPU, RAM, Network)
- MÃ©tricas de S3 (Storage, Requests)
- Logs de aplicaÃ§Ã£o
- Alarmes configurÃ¡veis

### Application Logs

```bash
# Ver logs em tempo real no EC2
docker-compose logs -f

# Logs especÃ­ficos
docker-compose logs frontend
docker-compose logs api
docker-compose logs db
```

---

## ðŸ”„ CI/CD Pipeline (Futuro)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  GitHub  â”‚â”€â”€â”€â”€>â”‚  GitHub  â”‚â”€â”€â”€â”€>â”‚  Docker  â”‚â”€â”€â”€â”€>â”‚   EC2    â”‚
â”‚   Push   â”‚     â”‚ Actions  â”‚     â”‚   Build  â”‚     â”‚  Deploy  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â”œâ”€> Run Tests
                       â”œâ”€> Build Images
                       â”œâ”€> Push to Registry
                       â””â”€> Deploy to Production
```

---

## ðŸ“š ReferÃªncias TÃ©cnicas

- [AWS EC2 Documentation](https://docs.aws.amazon.com/ec2/)
- [Docker Documentation](https://docs.docker.com/)
- [FastAPI Documentation](https://fastapi.tiangolo.com/)
- [React Documentation](https://react.dev/)
- [PostgreSQL Documentation](https://www.postgresql.org/docs/)

---

**Ãšltima atualizaÃ§Ã£o**: Dezembro 2024
**VersÃ£o da Arquitetura**: 1.0
**Ambiente**: ProduÃ§Ã£o (us-east-2)
